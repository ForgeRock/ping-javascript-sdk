<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@forgerock/iframe-manager | Documentation</title><meta name="description" content="Documentation for Documentation"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script><link rel="stylesheet" href="../assets/typedoc-github-style.css"/></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"><a href="https://github.com/ForgeRock/ping-javascript-sdk">GitHub</a></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Documentation</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">Documentation</a></li><li><a href="_forgerock_iframe-manager.html">@forgerock/iframe-manager</a></li></ul><h1>Module @forgerock/iframe-manager</h1></div><section class="tsd-panel tsd-typography"><a id="iframe-manager-pingidentitysdk-effectsiframe-manager" class="tsd-anchor"></a><h1 class="tsd-anchor-link">IFrame Manager (<code>@pingidentity/sdk-effects/iframe-manager</code>)<a href="#iframe-manager-pingidentitysdk-effectsiframe-manager" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overview<a href="#overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The IFrame Manager Effect provides a mechanism to perform operations within a hidden <code>&lt;iframe&gt;</code> that involve navigating to an external URL and waiting for a redirect back to the application's origin. It's commonly used for flows like silent authentication or fetching tokens where user interaction is not required, and the result is communicated via query parameters in the final redirect URL.</p>
<p>The core functionality involves:</p>
<ol>
<li>Creating a hidden <code>&lt;iframe&gt;</code> dynamically.</li>
<li>Navigating the iframe to a specified URL.</li>
<li>Monitoring the iframe's <code>load</code> events to detect navigation changes.</li>
<li>Once a navigation occurs back to the <strong>same origin</strong> as the parent application, parsing the query parameters from the iframe's URL.</li>
<li>Resolving or rejecting a Promise based on the presence of predefined &quot;success&quot; or &quot;error&quot; query parameters.</li>
<li>Handling timeouts and potential errors (like cross-origin access restrictions).</li>
</ol>
<p><strong>Key Constraint: Same-Origin Policy</strong></p>
<p>This utility fundamentally relies on the browser's <strong>Same-Origin Policy</strong>. The final URL that the iframe is redirected to (the one containing the expected <code>successParams</code> or <code>errorParams</code>) <strong>MUST</strong> be on the exact same origin (protocol, hostname, and port) as the main application window. Attempting to access the location (<code>contentWindow.location</code>) of an iframe pointing to a different origin will be blocked by the browser, causing the operation to fail.</p>
<a id="installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This effect is typically part of a larger SDK. Assume it's imported or available within your project structure like so (adjust path as necessary):</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">iFrameManager</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./path/to/iframe-manager.effects&#39;</span><span class="hl-1">; </span><span class="hl-5">// Adjust path as needed</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">iframeMgr</span><span class="hl-1"> = </span><span class="hl-0">iFrameManager</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<a id="api-reference" class="tsd-anchor"></a><h2 class="tsd-anchor-link">API Reference<a href="#api-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="iframemanager" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>iFrameManager()</code><a href="#iframemanager" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This is the main factory function that initializes the effect.</p>
<ul>
<li><strong>Returns:</strong> <code>object</code> - An object containing the API methods for managing iframe requests.</li>
</ul>
<a id="iframemgrgetparamsbyredirectoptions-getparamsfromiframeoptions-promise" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>iframeMgr.getParamsByRedirect(options: GetParamsFromIFrameOptions): Promise&lt;ResolvedParams&gt;</code><a href="#iframemgrgetparamsbyredirectoptions-getparamsfromiframeoptions-promise" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This method creates a hidden iframe, initiates navigation, and waits for a redirect back to the application's origin containing specific query parameters.</p>
<ul>
<li>
<p><strong><code>options</code></strong>: <code>GetParamsFromIFrameOptions</code> - An object containing configuration for the iframe request.</p>
<ul>
<li><strong><code>url: string</code></strong>: The initial URL to load within the hidden iframe. This URL is expected to eventually redirect back to the application's origin.</li>
<li><strong><code>timeout: number</code></strong>: The maximum time in milliseconds to wait for the entire operation to complete successfully (i.e., for a redirect containing success or error parameters). If the timeout is reached before completion, the promise rejects.</li>
</ul>
<ul>
<li><strong><code>successParams: string[]</code></strong>: An array of query parameter <em>keys</em>. If the final redirect URL (on the same origin) contains <strong>at least one</strong> of these keys in its query string, the promise will <strong>resolve</strong>.</li>
<li><strong><code>errorParams: string[]</code></strong>: An array of query parameter <em>keys</em>. If the final redirect URL (on the same origin) contains <strong>any</strong> of these keys in its query string, the promise will <strong>reject</strong>. Error parameters are checked <em>before</em> success parameters.
<ul>
<li><em>Note:</em> Both <code>successParams</code> and <code>errorParams</code> must be provided and contain at least one key.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Returns</strong>: <code>Promise&lt;ResolvedParams&gt;</code></p>
<ul>
<li><strong>On Success</strong>: Resolves with <code>ResolvedParams</code>, an object containing <em>all</em> query parameters parsed from the final redirect URL's query string. This occurs when the iframe redirects back to the same origin and its URL contains at least one key listed in <code>successParams</code> (and no keys listed in <code>errorParams</code>).</li>
<li><strong>On Failure</strong>: Rejects with:
<ul>
<li><code>ResolvedParams</code>: An object containing <em>all</em> parsed query parameters if the final redirect URL contains any key listed in <code>errorParams</code>.</li>
<li>An object <code>{ type: 'internal_error', message: 'iframe timed out' }</code> if the specified <code>timeout</code> is reached before a success or error condition is met.</li>
<li>An object <code>{ type: 'internal_error', message: 'unexpected failure' }</code> if there's an error accessing the iframe's content window (most likely due to a cross-origin redirect that wasn't expected or handled).</li>
<li>An object <code>{ type: 'internal_error', message: 'error setting up iframe' }</code> if there was an issue creating or configuring the iframe initially.</li>
<li>An <code>Error</code> if <code>successParams</code> or <code>errorParams</code> are missing or empty during setup.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>ResolvedParams</code></strong>: <code>Record&lt;string, string&gt;</code> - A simple key-value object representing the parsed query parameters.</p>
</li>
</ul>
<a id="usage-example" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage Example<a href="#usage-example" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">iFrameManager</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./path/to/iframe-manager.effects&#39;</span><span class="hl-1">; </span><span class="hl-5">// Adjust path</span><br/><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">iframeMgr</span><span class="hl-1"> = </span><span class="hl-0">iFrameManager</span><span class="hl-1">();</span><br/><br/><span class="hl-6">async</span><span class="hl-1"> </span><span class="hl-6">function</span><span class="hl-1"> </span><span class="hl-0">performSilentLogin</span><span class="hl-1">(</span><span class="hl-4">authUrl</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">options</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-4">url:</span><span class="hl-1"> </span><span class="hl-4">authUrl</span><span class="hl-1">, </span><span class="hl-5">// e.g., &#39;https://auth.example.com/authorize?prompt=none&amp;client_id=...&#39;</span><br/><span class="hl-1">    </span><span class="hl-4">timeout:</span><span class="hl-1"> </span><span class="hl-9">10000</span><span class="hl-1">, </span><span class="hl-5">// 10 seconds timeout</span><br/><span class="hl-1">    </span><span class="hl-4">successParams:</span><span class="hl-1"> [</span><span class="hl-2">&#39;code&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;id_token&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;session_state&#39;</span><span class="hl-1">], </span><span class="hl-5">// Expect one of these on success</span><br/><span class="hl-1">    </span><span class="hl-4">errorParams:</span><span class="hl-1"> [</span><span class="hl-2">&#39;error&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;error_description&#39;</span><span class="hl-1">], </span><span class="hl-5">// Expect one of these on failure</span><br/><span class="hl-1">  };</span><br/><br/><span class="hl-1">  </span><span class="hl-3">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Attempting silent login via iframe...&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// The promise resolves/rejects when the iframe redirects back to *this* app&#39;s origin</span><br/><span class="hl-1">    </span><span class="hl-5">// with appropriate query parameters.</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">resultParams</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">iframeMgr</span><span class="hl-1">.</span><span class="hl-0">getParamsByRedirect</span><span class="hl-1">(</span><span class="hl-4">options</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-5">// Success case: &#39;code&#39;, &#39;id_token&#39;, or &#39;session_state&#39; was present</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Silent login successful. Received params:&#39;</span><span class="hl-1">, </span><span class="hl-4">resultParams</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">// Process the received parameters (e.g., exchange code for token)</span><br/><span class="hl-1">    </span><span class="hl-5">// const code = resultParams.code;</span><br/><span class="hl-1">    </span><span class="hl-5">// const state = resultParams.state; // Other params are included too</span><br/><span class="hl-1">  } </span><span class="hl-3">catch</span><span class="hl-1"> (</span><span class="hl-4">errorResult</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">// Failure case: Check if it&#39;s a known error from the server or an internal error</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">errorResult</span><span class="hl-1"> &amp;&amp; </span><span class="hl-4">errorResult</span><span class="hl-1">.</span><span class="hl-4">type</span><span class="hl-1"> === </span><span class="hl-2">&#39;internal_error&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">// Timeout or iframe access error</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">`Iframe operation failed: </span><span class="hl-6">${</span><span class="hl-4">errorResult</span><span class="hl-10">.</span><span class="hl-4">message</span><span class="hl-6">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-3">else</span><span class="hl-1"> </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">errorResult</span><span class="hl-1"> &amp;&amp; (</span><span class="hl-4">errorResult</span><span class="hl-1">.</span><span class="hl-4">error</span><span class="hl-1"> || </span><span class="hl-4">errorResult</span><span class="hl-1">.</span><span class="hl-4">error_description</span><span class="hl-1">)) {</span><br/><span class="hl-1">      </span><span class="hl-5">// Error reported by the authorization server via errorParams</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;Silent login failed. Server returned error:&#39;</span><span class="hl-1">, </span><span class="hl-4">errorResult</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">// const errorCode = errorResult.error;</span><br/><span class="hl-1">      </span><span class="hl-5">// const errorDesc = errorResult.error_description;</span><br/><span class="hl-1">    } </span><span class="hl-3">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-5">// Other unexpected error</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;An unexpected error occurred:&#39;</span><span class="hl-1">, </span><span class="hl-4">errorResult</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">// Example usage:</span><br/><span class="hl-5">// Assuming your app is running on https://app.example.com</span><br/><span class="hl-5">// and the auth server will redirect back to https://app.example.com/callback?code=... or ?error=...</span><br/><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">authorizationUrl</span><span class="hl-1"> =</span><br/><span class="hl-1">  </span><span class="hl-2">&#39;https://auth.example.com/authorize?prompt=none&amp;client_id=abc&amp;redirect_uri=https://app.example.com/callback&amp;response_type=code&amp;scope=openid&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">performSilentLogin</span><span class="hl-1">(</span><span class="hl-4">authorizationUrl</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="important-considerations" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Important Considerations<a href="#important-considerations" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ol>
<li><strong>Same-Origin Redirect:</strong> This cannot be stressed enough. The URL specified in <code>options.url</code> <em>must</em> eventually redirect back to a URL on the <strong>same origin</strong> as your main application for this mechanism to work. Cross-origin restrictions will prevent the script from reading the final URL's parameters otherwise.</li>
<li><strong>Timeout:</strong> Choose a reasonable <code>timeout</code> value. If the external service is slow or the redirect chain is long, the operation might time out prematurely. Conversely, too long a timeout might delay feedback to the user if something goes wrong.</li>
<li><strong>Intermediate Redirects:</strong> The code handles intermediate redirects (pages loaded within the iframe that don't contain success or error parameters) by simply waiting for the next <code>load</code> event. The process only completes upon detecting success/error parameters or timing out.</li>
<li><strong>Cleanup:</strong> The utility ensures the iframe element is removed from the DOM and the timeout timer is cleared upon completion (resolve, reject, or timeout) to prevent memory leaks.</li>
<li><strong>Error Parameter Precedence:</strong> Error parameters (<code>errorParams</code>) are checked before success parameters (<code>successParams</code>). If a redirect URL contains both an error parameter and a success parameter, the promise will be <strong>rejected</strong>.</li>
</ol>
</section><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Interfaces"><h2><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg> Interfaces</h2></summary><dl class="tsd-member-summaries"><dt class="tsd-member-summary"><a id="getparamsfromiframeoptions" class="tsd-anchor"></a><span class="tsd-member-summary-name"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><a href="../interfaces/_forgerock_iframe-manager.GetParamsFromIFrameOptions.html">GetParamsFromIFrameOptions</a><a href="#getparamsfromiframeoptions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></span></dt><dd class="tsd-member-summary"></dd></dl></details></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#iframe-manager-pingidentitysdk-effectsiframe-manager"><span>IFrame <wbr/>Manager (@pingidentity/sdk-<wbr/>effects/iframe-<wbr/>manager)</span></a><ul><li><a href="#overview"><span>Overview</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><a href="#api-reference"><span>API <wbr/>Reference</span></a></li><li><ul><li><a href="#iframemanager"><span>i<wbr/>Frame<wbr/>Manager()</span></a></li><li><a href="#iframemgrgetparamsbyredirectoptions-getparamsfromiframeoptions-promise"><span>iframe<wbr/>Mgr.get<wbr/>Params<wbr/>By<wbr/>Redirect(options: <wbr/>Get<wbr/>Params<wbr/>FromIFrame<wbr/>Options): <wbr/>Promise&lt;<wbr/>Resolved<wbr/>Params&gt;</span></a></li></ul></li><li><a href="#usage-example"><span>Usage <wbr/>Example</span></a></li><li><a href="#important-considerations"><span>Important <wbr/>Considerations</span></a></li></ul><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Interfaces"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Interfaces</summary><div><a href="#getparamsfromiframeoptions" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Interface"><use href="../assets/icons.svg#icon-256"></use></svg><span>Get<wbr/>Params<wbr/>FromIFrame<wbr/>Options</span></a></div></details></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/ForgeRock/ping-javascript-sdk" class="tsd-nav-link">GitHub</a></nav><nav class="tsd-navigation"><a href="../index.html">Documentation</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer></footer><div class="overlay"></div></body></html>
